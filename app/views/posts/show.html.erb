<div id="show">
	<div class="actions">
		<%= render :partial => 'ranking', :locals => {:post => @post} %>
		<%= link_to content_tag(:span, 'Edit'), new_child_post_path(@post), :class => 'edit' %>

		<% if belongs_to_current_user(@post) %>
			<%= link_to content_tag(:span, 'Delete'), @post, :class => 'delete', :confirm => 'Are you sure?', :method => :delete %>
		<% end %>
		<a href="#" class="previous"><span>Previous</span></a>
		<a href="#" class="zoom"><span>Zoom</span></a>
		<a href="#" class="next"><span>Next</span></a>
		<%# TODO: Make Next / Previous / Zoom Links work %>
	</div>
	<% if @post.photo.exists? then %>
		<%= image_tag @post.photo.url(:medium), :class => 'medium' %></p>
	<% else %>
		<p>Error: No photo.</p>
	<% end %>
</div>
<div id="meta">
	<div class="post_title">
		<h1><%= best_in_place_if @post.user == current_user, @post, :title %></h1>
		<span class="by">by <%= link_to @post.user.username, name_user_path(@post.user.username) %></span>
	</div>
	<p>
	  <b>Description:</b>
	  <%= best_in_place_if @post.user == current_user, @post, :description, :type => :textarea %>
	</p>

	<p>
	  <b>Tags:</b>
	  <%= tag_links(@post) %>
		<%# TODO: find a way to get in-place tag add/delete %>
	</p>

	<% unless @post.parents.empty? %>
		<h3>Parents</h3>
		<% for parent in @post.parents %>
		<%= link_to(image_tag(parent.photo(:thumb)), parent, :class => 'relation') %>
		<% end %>
	<% end %>
	<% unless @post.inverse_relationships.empty? %>
		<h3>Children</h3>
		<% for relationship in @post.inverse_relationships %>
		<%= link_to(image_tag(relationship.post.photo(:thumb)), relationship.post, :class => 'relation') %>
		<% end %>
	<% end %>

	<h2>Comments</h2>
	<div id="comments">
		<%= render @post.comments - [@comment] %>
	</div>

	<h2>Add a comment:</h2>
	<%= form_for([@post, @comment], :remote => true) do |f| %>
	  <% if @comment.errors.any? %>
	    <div id="error_explanation">
	      <h2><%= pluralize(@comment.errors.count, "error") %> prohibited this comment from being saved:</h2>

	      <ul>
	      <% @comment.errors.full_messages.each do |msg| %>
	        <li><%= msg %></li>
	      <% end %>
	      </ul>
	    </div>
	  <% end %>
	  <div class="field">
	    <%= f.text_area :body, :cols => 40, :rows => 6 %>
	  </div>
	    <%= f.submit %>
	<% end %>
</div>

<%# link_to 'Edit', edit_post_path(@post) %>
<div class="clearfix"></div>
